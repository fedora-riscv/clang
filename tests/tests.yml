- hosts: localhost
  roles:
  - role: standard-test-basic
    tags:
      - classic
    required_packages:
      - clang
      - llvm-test-suite
      - ninja-build
      - gcc-x86_64-linux-gnu
      # FIXME: It would be nice if we could only install dependencies for a
      # single test rather than installing dependencies for all tests.  This
      # will help us catch bugs with implicit package dependencies e.g.
      # package A depends on package B but does not have an explicit Requires.
      # These are required for the llvm-toolchain test:
      - clang
      - lld
      - compiler-rt
      - libcxx-devel
      - libcxx-static
      - glibc-devel
      - glibc-static
      - gcc
      # Required for fedora-flags:
      - annobin
      - redhat-rpm-config

    repositories:
    - repo: "https://src.fedoraproject.org/tests/llvm-test-suite.git"
      dest: "llvm-test-suite"
    - repo: "https://src.fedoraproject.org/tests/clang.git"
      dest: "clang"
    tests:
      - rhbz#482491:
          dir: ./
          run: find /usr -name 'libgcc_s.so*' && echo "int main(){}" | clang -v -x c -
      - llvm-test-suite/test-suite
      # ABI test suite is too greedy on the FS
      #- llvm-test-suite/abi-test-suite
      - clang/rhbz_1657544
      - clang/rhbz_1647130
      - clang/llvm-toolchain
      - clang/fedora-flags
      - clang/toolchains
